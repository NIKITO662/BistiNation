<!DOCTYPE html>
<html lang="bg">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BistiNationAuras</title>
    <style>
        body {
            background-color: black; /* –ß–µ—Ä–µ–Ω —Ñ–æ–Ω */
            color: white; /* –ë—è–ª —Ç–µ–∫—Å—Ç */
            font-family: Arial, sans-serif; /* –®—Ä–∏—Ñ—Ç */
            display: flex; /* –ò–∑–ø–æ–ª–∑–≤–∞–º–µ flexbox –∑–∞ —Ü–µ–Ω—Ç—Ä–∏—Ä–∞–Ω–µ */
            flex-direction: column; /* –ü–æ–¥—Ä–µ–∂–¥–∞–Ω–µ –ø–æ –∫–æ–ª–æ–Ω–∞ */
            align-items: center; /* –¶–µ–Ω—Ç—Ä–∏—Ä–∞–Ω–µ –ø–æ —Ö–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª–∞ */
            justify-content: center; /* –¶–µ–Ω—Ç—Ä–∏—Ä–∞–Ω–µ –ø–æ –≤–µ—Ä—Ç–∏–∫–∞–ª–∞ */
            height: 100vh; /* –í–∏—Å–æ—á–∏–Ω–∞ –Ω–∞ –≤–∏–¥–∏–º–∞—Ç–∞ —á–∞—Å—Ç –Ω–∞ –µ–∫—Ä–∞–Ω–∞ */
            margin: 0; /* –ù—è–º–∞ –æ—Ç—Å—Ç–æ—è–Ω–∏–µ */
        }

        h1 {
            margin-bottom: 20px; /* –û—Ç—Å—Ç–æ—è–Ω–∏–µ –ø–æ–¥ –∑–∞–≥–ª–∞–≤–∏–µ—Ç–æ */
        }

        .timer {
            font-size: 24px; /* –†–∞–∑–º–µ—Ä –Ω–∞ —à—Ä–∏—Ñ—Ç–∞ –∑–∞ —Ç–∞–π–º–µ—Ä–∞ */
            margin-bottom: 20px; /* –û—Ç—Å—Ç–æ—è–Ω–∏–µ –ø–æ–¥ —Ç–∞–π–º–µ—Ä–∞ */
        }

        .button-row {
            display: flex; /* –ü–æ–¥—Ä–µ–∂–¥–∞–Ω–µ –Ω–∞ –±—É—Ç–æ–Ω–∏—Ç–µ –≤ —Ä–µ–¥ */
            justify-content: center; /* –¶–µ–Ω—Ç—Ä–∏—Ä–∞–Ω–µ –Ω–∞ –±—É—Ç–æ–Ω–∏—Ç–µ */
            margin-bottom: 20px; /* –û—Ç—Å—Ç–æ—è–Ω–∏–µ –ø–æ–¥ —Ä–µ–¥–∞ —Å –±—É—Ç–æ–Ω–∏—Ç–µ */
        }

        .biCoins {
            padding: 10px 20px; /* –û—Ç—Å—Ç–æ—è–Ω–∏–µ –æ–∫–æ–ª–æ BiCoins */
            font-size: 16px; /* –†–∞–∑–º–µ—Ä –Ω–∞ —à—Ä–∏—Ñ—Ç–∞ */
            background-color: #444; /* –¢—ä–º–µ–Ω —Ñ–æ–Ω –Ω–∞ BiCoins */
            color: white; /* –ë—è–ª —Ç–µ–∫—Å—Ç –Ω–∞ BiCoins */
            border: none; /* –ë–µ–∑ —Ä–∞–º–∫–∞ */
            border-radius: 5px; /* –ó–∞–∫—Ä—ä–≥–ª–µ–Ω–∏ —ä–≥–ª–∏ */
            margin: 5px; /* –û—Ç—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É –±—É—Ç–æ–Ω–∏—Ç–µ */
        }

        button {
            padding: 10px 20px; /* –û—Ç—Å—Ç–æ—è–Ω–∏–µ –æ–∫–æ–ª–æ –±—É—Ç–æ–Ω–∞ */
            font-size: 16px; /* –†–∞–∑–º–µ—Ä –Ω–∞ —à—Ä–∏—Ñ—Ç–∞ */
            cursor: pointer; /* –ö—É—Ä—Å–æ—Ä –ø—Ä–∏ –∑–∞–¥—ä—Ä–∂–∞–Ω–µ –Ω–∞–¥ –±—É—Ç–æ–Ω–∞ */
            background-color: #444; /* –¢—ä–º–µ–Ω —Ñ–æ–Ω –Ω–∞ –±—É—Ç–æ–Ω–∞ */
            color: white; /* –ë—è–ª —Ç–µ–∫—Å—Ç –Ω–∞ –±—É—Ç–æ–Ω–∞ */
            border: none; /* –ë–µ–∑ —Ä–∞–º–∫–∞ */
            border-radius: 5px; /* –ó–∞–∫—Ä—ä–≥–ª–µ–Ω–∏ —ä–≥–ª–∏ */
            margin: 5px; /* –û—Ç—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É –±—É—Ç–æ–Ω–∏—Ç–µ */
        }

        button:hover {
            background-color: #666; /* –ü–æ-—Å–≤–µ—Ç—ä–ª —Ñ–æ–Ω –ø—Ä–∏ –∑–∞–¥—ä—Ä–∂–∞–Ω–µ */
        }

        .result {
            margin-top: 20px; /* –û—Ç—Å—Ç–æ—è–Ω–∏–µ –Ω–∞–¥ —Ä–µ–∑—É–ª—Ç–∞—Ç–∞ */
            text-align: center; /* –¶–µ–Ω—Ç—Ä–∏—Ä–∞–Ω–µ –Ω–∞ —Ç–µ–∫—Å—Ç–∞ */
            transition: transform 0.5s; /* –ü–ª–∞–≤–µ–Ω –ø—Ä–µ—Ö–æ–¥ –∑–∞ –∞–Ω–∏–º–∞—Ü–∏—è—Ç–∞ */
        }

        .spin {
            animation: spin 0.5s forwards; /* –ê–Ω–∏–º–∞—Ü–∏—è –Ω–∞ –∑–∞–≤—ä—Ä—Ç–∞–Ω–µ */
        }

        @keyframes spin {
            from {
                transform: rotate(0deg); /* –ù–∞—á–∞–ª–Ω–∞ –ø–æ–∑–∏—Ü–∏—è */
            }
            to {
                transform: rotate(360deg); /* –ö—Ä–∞–π–Ω–∞ –ø–æ–∑–∏—Ü–∏—è */
            }
        }

        .inventory {
            margin-top: 20px; /* –û—Ç—Å—Ç–æ—è–Ω–∏–µ –Ω–∞–¥ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–∞ */
            text-align: center; /* –¶–µ–Ω—Ç—Ä–∏—Ä–∞–Ω–µ –Ω–∞ —Ç–µ–∫—Å—Ç–∞ */
            display: none; /* –°–∫—Ä–∏—Ç–æ –ø–æ –ø–æ–¥—Ä–∞–∑–±–∏—Ä–∞–Ω–µ */
            position: absolute; /* –ü–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–∞–Ω–µ –Ω–∞ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–∞ */
            top: 20px; /* –†–∞–∑—Å—Ç–æ—è–Ω–∏–µ –æ—Ç –≥–æ—Ä–Ω–∞—Ç–∞ —á–∞—Å—Ç */
            right: 20px; /* –†–∞–∑—Å—Ç–æ—è–Ω–∏–µ –æ—Ç –¥—è—Å–Ω–∞—Ç–∞ —á–∞—Å—Ç */
            background-color: rgba(0, 0, 0, 0.8); /* –ü–æ–ª—É–ø—Ä–æ–∑—Ä–∞—á–µ–Ω —Ñ–æ–Ω */
            padding: 15px; /* –û—Ç—Å—Ç–æ—è–Ω–∏–µ –æ–∫–æ–ª–æ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–∞ */
            border-radius: 5px; /* –ó–∞–∫—Ä—ä–≥–ª–µ–Ω–∏ —ä–≥–ª–∏ */
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.2); /* –õ–µ–∫–∞ —Å—è–Ω–∫–∞ */
        }

        .inventory h2 {
            margin: 0; /* –ù—è–º–∞ –æ—Ç—Å—Ç–æ—è–Ω–∏–µ */
        }

        footer {
            margin-top: 20px; /* –û—Ç—Å—Ç–æ—è–Ω–∏–µ –Ω–∞–¥ —Ñ—É—Ç–µ—Ä–∞ */
            text-align: center; /* –¶–µ–Ω—Ç—Ä–∏—Ä–∞–Ω–µ –Ω–∞ —Ç–µ–∫—Å—Ç–∞ */
            color: gray; /* –¶–≤—è—Ç –Ω–∞ —Ç–µ–∫—Å—Ç–∞ */
        }

        .music-player {
            margin-top: 20px; /* –û—Ç—Å—Ç–æ—è–Ω–∏–µ –Ω–∞–¥ –º—É–∑–∏–∫–∞–ª–Ω–∏—è –ø–ª–µ–π—ä—Ä */
            text-align: center; /* –¶–µ–Ω—Ç—Ä–∏—Ä–∞–Ω–µ –Ω–∞ —Ç–µ–∫—Å—Ç–∞ */
        }

        .login-button {
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <div class="timer" id="timer"></div> <!-- –¢–∞–π–º–µ—Ä -->
    <h1>BistiNationAuras</h1>

    <!-- Login Button -->
    <button class="login-button" onclick="loginWithDiscord()">–í—Ö–æ–¥ —Å Discord</button>

    <div class="button-row" id="gameControls" style="display: none;">
        <div class="biCoins">BiCoins: <span id="biCoins">0</span></div>
        <button onclick="toggleInventory()">–ò–Ω–≤–µ–Ω—Ç–∞—Ä</button>
        <button onclick="showAurasChance()">–®–∞–Ω—Å–æ–≤–µ –∑–∞ –ê—É—Ä–∏</button>
    </div>
    <button id="rollButton" onclick="roll()" style="margin-top: 20px; display: none;">Roll</button>
    <div class="result" id="result"></div>
    <div class="inventory" id="inventory">
        <h2>–ò–Ω–≤–µ–Ω—Ç–∞—Ä</h2>
        <button class="close-btn" onclick="toggleInventory()">X</button>
        <ul id="inventoryList"></ul>
        <button id="sellButton" onclick="sellAura()" style="display: none;">Sell</button>
    </div>

    <footer style="margin-top: 20px; text-align: center; color: gray;">
        &copy; 2024 BistiNation. –í—Å–∏—á–∫–∏ –ø—Ä–∞–≤–∞ –∑–∞–ø–∞–∑–µ–Ω–∏.
    </footer>

    <script>
        let biCoins = 0; // Initialize BiCoins
        let canRoll = true; // Flag to control rolling
        let discordUser = null; // Variable to store Discord user info

        // Aura data
        const auras = [
            { name: "Common", chance: "1/2", probability: 50 },
            { name: "Uncommon", chance: "1/4", probability: 25 },
            { name: "Good", chance: "1/8", probability: 12.5 },
            { name: "Natural", chance: "1/12", probability: 8.33 },
            { name: "Rare", chance: "1/24", probability: 4.17 },
            { name: "Divinus", chance: "1/48", probability: 2.08 },
            { name: "Crystallized", chance: "1/96", probability: 1.04 },
            { name: "Rage", chance: "1/192", probability: 0.52 },
            { name: "Topaz", chance: "1/225", probability: 0.44 },
            { name: "Glacier", chance: "1/384", probability: 0.26 },
            { name: "Wind", chance: "1/450", probability: 0.22 },
            { name: "Ruby", chance: "1/525", probability: 0.19 },
            { name: "Forbidden", chance: "1/606", probability: 0.165 },
            { name: "Emerald", chance: "1/750", probability: 0.133 },
            { name: "Gilded", chance: "1/768", probability: 0.130 },
            { name: "Ink", chance: "1/1050", probability: 0.095 },
            { name: "Jackpot", chance: "1/1155", probability: 0.086 },
            { name: "Sapphire", chance: "1/1200", probability: 0.083 },
            { name: "Aquamarine", chance: "1/1350", probability: 0.074 },
            { name: "Comet Rain", chance: "1/12000", probability: 0.00833 },
            { name: "Gambling Addiction", chance: "1/12000", probability: 0.00833 },
            { name: "Rage: Heated", chance: "1/12800", probability: 0.00781 },
            { name: "Blood LEAK", chance: "1/14000", probability: 0.00714 },
            { name: "Powered Guy", chance: "1/16384", probability: 0.0061 },
            { name: "Permafrost", chance: "1/24500", probability: 0.00408 },
            { name: "Stormal God", chance: "1/30000", probability: 0.00333 },
            { name: "Aquatic Guard", chance: "1/40000", probability: 0.0025 },
            { name: "Flushed Lobotomy", chance: "1/69000", probability: 0.00145 },
            { name: "Nautilus", chance: "1/70000", probability: 0.00143 },
            { name: "HAZARD Problems", chance: "1/70000", probability: 0.00143 },
            { name: "Fallen Angel", chance: "1/73500", probability: 0.00136 },
            { name: "Exotic Master", chance: "1/99999", probability: 0.00001 },
            { name: "Undead: Devil", chance: "1/100000", probability: 0.00001 }
        ];

        // –¢–∞–π–º–µ—Ä
        function startTimer() {
            const endTime = new Date();
            endTime.setDate(endTime.getDate() + 1); // –£—Ç—Ä–µ
            endTime.setHours(9, 40, 0); // 09:40

            const timerElement = document.getElementById("timer");

            function updateTimer() {
                const now = new Date();
                const timeRemaining = endTime - now;

                if (timeRemaining <= 0) {
                    timerElement.textContent = "–¢–∞–π–º–µ—Ä—ä—Ç –µ –∏–∑—Ç–µ–∫—ä–ª!";
                    clearInterval(timerInterval);
                    return;
                }

                const hours = Math.floor((timeRemaining % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const minutes = Math.floor((timeRemaining % (1000 * 60 * 60)) / (1000 * 60));
                const seconds = Math.floor((timeRemaining % (1000 * 60)) / 1000);
                timerElement.textContent = `–û—Å—Ç–∞–≤–∞—â–æ –≤—Ä–µ–º–µ: ${hours}—á ${minutes}–º ${seconds}—Å`;
            }

            updateTimer(); // Initial call
            const timerInterval = setInterval(updateTimer, 1000);
        }

        function loginWithDiscord() {
            const clientId = '1301883048433942662'; // –í–∞—à–∏—è—Ç Discord Client ID
            const redirectUri = encodeURIComponent('https://nikito662.github.io/BistiNation/'); // –í–∞—à–∏—è—Ç Redirect URI
            const scope = 'identify'; // –ü—Ä–∞–≤–∞ –∑–∞ –¥–æ—Å—Ç—ä–ø
            const discordAuthUrl = `https://discord.com/oauth2/authorize?client_id=${clientId}&redirect_uri=${redirectUri}&response_type=token&scope=${scope}`;
            window.location.href = discordAuthUrl; // –ü—Ä–µ–Ω–∞—Å–æ—á–≤–∞–Ω–µ –∫—ä–º Discord –∑–∞ –≤—Ö–æ–¥
        }

        function handleDiscordResponse() {
            const hash = window.location.hash;
            if (hash) {
                const params = new URLSearchParams(hash.substring(1));
                const accessToken = params.get('access_token');

                if (accessToken) {
                    fetch('https://discord.com/api/users/@me', {
                        headers: {
                            'Authorization': `Bearer ${accessToken}`
                        }
                    })
                    .then(response => response.json())
                    .then(data => {
                        discordUser = data; // –ó–∞–ø–∞–∑–≤–∞–Ω–µ –Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –∑–∞ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è
                        document.querySelector('.login-button').style.display = 'none'; // –°–∫—Ä–∏–≤–∞–Ω–µ –Ω–∞ –±—É—Ç–æ–Ω–∞ –∑–∞ –≤—Ö–æ–¥
                        document.getElementById('gameControls').style.display = 'flex'; // –ü–æ–∫–∞–∑–≤–∞–Ω–µ –Ω–∞ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ç–µ –Ω–∞ –∏–≥—Ä–∞—Ç–∞
                        startTimer(); // –°—Ç–∞—Ä—Ç–∏—Ä–∞–Ω–µ –Ω–∞ —Ç–∞–π–º–µ—Ä–∞
                        loadInventory(); // –ó–∞—Ä–µ–∂–¥–∞–Ω–µ –Ω–∞ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–∞ –æ—Ç localStorage
                    });
                }
            }
        }

        function loadInventory() {
            const inventory = JSON.parse(localStorage.getItem('inventory')) || [];
            const inventoryList = document.getElementById("inventoryList");
            inventoryList.innerHTML = ''; // –ò–∑—á–∏—Å—Ç–≤–∞–Ω–µ –Ω–∞ —Ç–µ–∫—É—â–∏—è –∏–Ω–≤–µ–Ω—Ç–∞—Ä

            inventory.forEach(item => {
                const listItem = document.createElement("li");
                listItem.textContent = `${item.name} x${item.count} (${item.chance})`;
                listItem.dataset.count = item.count; // –ó–∞–ø–∞–∑–≤–∞–Ω–µ –Ω–∞ –±—Ä–æ—è –≤ dataset
                inventoryList.appendChild(listItem);
            });

            // –ü–æ–∫–∞–∑–≤–∞–Ω–µ –Ω–∞ –±—É—Ç–æ–Ω–∞ –∑–∞ –ø—Ä–æ–¥–∞–∂–±–∞, –∞–∫–æ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—ä—Ç –Ω–µ –µ –ø—Ä–∞–∑–µ–Ω
            document.getElementById("sellButton").style.display = inventory.length > 0 ? "block" : "none";
        }

        function saveInventory() {
            const inventoryList = document.getElementById("inventoryList");
            const inventory = Array.from(inventoryList.children).map(item => {
                const [name, countChance] = item.textContent.split(' x');
                const [count, chance] = countChance.split(' (');
                return {
                    name: name.trim(),
                    count: parseInt(count),
                    chance: chance.replace(')', '').trim()
                };
            });
            localStorage.setItem('inventory', JSON.stringify(inventory)); // –ó–∞–ø–∞–∑–≤–∞–Ω–µ –Ω–∞ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–∞ –≤ localStorage
        }

        function addAuraToInventory(aura) {
            const inventoryList = document.getElementById("inventoryList");
            const existingAura = Array.from(inventoryList.children).find(item => item.textContent.includes(aura.name));

            if (existingAura) {
                // Update count if aura already exists
                const count = parseInt(existingAura.dataset.count) + 1;
                existingAura.dataset.count = count;
                existingAura.textContent = `${aura.name} x${count} (${aura.chance})`;
            } else {
                // Add new aura to inventory
                const listItem = document.createElement("li");
                listItem.textContent = `${aura.name} x1 (${aura.chance})`;
                listItem.dataset.count = 1; // Store count in dataset
                inventoryList.appendChild(listItem);
            }

            // Show the Sell button if there are items in the inventory
            document.getElementById("sellButton").style.display = inventoryList.children.length > 0 ? "block" : "none";
            saveInventory(); // –ó–∞–ø–∞–∑–≤–∞–Ω–µ –Ω–∞ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–∞
        }

        function roll() {
            if (!canRoll) return;

            canRoll = false; // Disable rolling
            const randomValue = Math.random() * 100; // Generate a random number between 0 and 100
            let selectedAura = null;

            // Determine which aura is rolled based on the probabilities
            for (const aura of auras) {
                if (randomValue <= aura.probability) {
                    selectedAura = aura;
                    break;
                }
            }

            if (selectedAura) {
                addAuraToInventory(selectedAura); // Add the rolled aura to the inventory
                sendDiscordNotification(selectedAura); // Send notification to Discord
                document.getElementById("result").textContent = `–ü–æ–ª—É—á–∏—Ö—Ç–µ: ${selectedAura.name}!`;
            } else {
                document.getElementById("result").textContent = "–ù—è–º–∞ –ø–æ–ª—É—á–µ–Ω–∞ –∞—É—Ä–∞.";
            }

            canRoll = true; // Enable rolling again
        }

        function sendDiscordNotification(aura) {
            const webhookURL = 'https://discord.com/api/webhooks/1301879434436939848/ZRG3iTfPTxIuEI7c-IEM0ESoYr2YTrjsGfE5saaHneVdIeJm6hho3WwjWK7n41kWDpos'; // –í–∞—à–∏—è—Ç Webhook URL
            const message = {
                content: `üéâ ${discordUser.username} –ø–æ–ª—É—á–∏ ${aura.name} (${aura.chance})!`, // –ò–∑–ø–æ–ª–∑–≤–∞–Ω–µ –Ω–∞ Discord –∏–º–µ—Ç–æ
            };

            fetch(webhookURL, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(message),
            })
            .then(response => {
                if (!response.ok) {
                    console.error('Error sending Discord notification:', response.statusText);
                }
            })
            .catch(error => {
                console.error('Error sending Discord notification:', error);
            });
        }

        // –û–±—Ä–∞–±–æ—Ç–≤–∞–Ω–µ –Ω–∞ –æ—Ç–≥–æ–≤–æ—Ä–∞ –æ—Ç Discord
        handleDiscordResponse();
    </script>
</body>
</html>
