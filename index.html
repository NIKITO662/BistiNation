<!DOCTYPE html>
<html lang="bg">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-store, no-cache, must-revalidate, max-age=0">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self' https://cse.google.com; script-src 'self' 'unsafe-inline' https://cse.google.com; style-src 'self' 'unsafe-inline' https://cse.google.com;">
    <title>BistiAnonymous Анонимна Търсачка</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #25262a;
            color: #ffffff;
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }
        h1 {
            color: #7d82f0;
            text-align: center;
        }
        .logo {
            cursor: pointer;
            text-decoration: none;
            color: #7d82f0;
        }
        #search-container {
            width: 100%;
            max-width: 600px;
            margin-bottom: 20px;
            position: relative;
        }
        #search-box {
            width: 100%;
            padding: 10px 30px 10px 10px;
            font-size: 16px;
            border: none;
            border-radius: 24px;
            background-color: #ffffff;
            color: #000000;
        }
        #clear-search, #clear-data {
            background: none;
            border: none;
            color: #666;
            font-size: 18px;
            cursor: pointer;
        }
        #clear-search {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            display: none;
        }
        #clear-data {
            margin-top: 10px;
        }
        #results-container {
            width: 100%;
            max-width: 800px;
        }
        #privacy-disclaimer, #no-js-search {
            margin-top: 20px;
            font-size: 14px;
            color: #888;
            text-align: center;
        }
        #no-js-search {
            display: none;
        }
    </style>
</head>
<body>
    <h1><a href="/" class="logo">BistiAnonymous</a></h1>
    
    <div id="search-container">
        <input type="text" id="search-box" placeholder="Търсете анонимно...">
        <button id="clear-search">✕</button>
    </div>
    
    <button id="clear-data">Изчисти всички данни</button>

    <div id="results-container">
        <div class="gcse-searchresults-only"></div>
    </div>

    <form id="no-js-search" action="https://www.google.com/search" method="get" target="_blank">
        <input type="hidden" name="cx" value="60c020d44283f4851">
        <input type="text" name="q" placeholder="Търсене без JavaScript...">
        <input type="submit" value="Търси">
    </form>

    <div id="privacy-disclaimer">
        <p>Поверителност: Тази търсачка се стреми към максимална анонимност. Не съхраняваме история на търсенията или лични данни. Въпреки това, използваме Google Custom Search Engine, което може да събира ограничени данни. За повече информация, моля, прочетете нашата <a href="/privacy-policy.html" target="_blank" rel="noopener noreferrer">политика за поверителност</a>.</p>
    </div>

    <script async src="https://cse.google.com/cse.js?cx=60c020d44283f4851"></script>
    <script>
        function clearLocalData() {
            localStorage.clear();
            sessionStorage.clear();
            var cookies = document.cookie.split(";");
            for (var i = 0; i < cookies.length; i++) {
                var cookie = cookies[i];
                var eqPos = cookie.indexOf("=");
                var name = eqPos > -1 ? cookie.substr(0, eqPos) : cookie;
                document.cookie = name + "=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/";
            }
            console.log("Локалните данни и бисквитките бяха изчистени.");
        }

        function clearUrlParameters() {
            if (window.history && window.history.replaceState) {
                var cleanUrl = window.location.protocol + "//" + window.location.host + window.location.pathname;
                window.history.replaceState({}, document.title, cleanUrl);
            }
        }

        window.onload = function() {
            var searchBox = document.getElementById('search-box');
            var clearButton = document.getElementById('clear-search');
            var clearDataButton = document.getElementById('clear-data');
            var noJsSearch = document.getElementById('no-js-search');

            // Показване на формата за търсене без JavaScript
            noJsSearch.style.display = 'block';

            searchBox.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    var element = google.search.cse.element.getElement('searchresults-only0');
                    if (element) {
                        element.execute(searchBox.value);
                        setTimeout(function() {
                            clearLocalData();
                            clearUrlParameters();
                            setTimeout(function() {
                                searchBox.value = '';
                            }, 100);
                        }, 1000);
                    } else {
                        console.error('Search element not found');
                    }
                }
            });

            searchBox.addEventListener('input', function() {
                clearButton.style.display = this.value ? 'block' : 'none';
            });

            clearButton.addEventListener('click', function() {
                searchBox.value = '';
                clearButton.style.display = 'none';
                searchBox.focus();
            });

            clearDataButton.addEventListener('click', function() {
                clearLocalData();
                clearUrlParameters();
                location.reload();
            });

            // Уважаване на Do Not Track
            if (navigator.doNotTrack === "1") {
                console.log("Do Not Track е активирано. Допълнително ограничаване на проследяването.");
                // Тук можете да добавите допълнителна логика за ограничаване на проследяването
            }

            var style = document.createElement('style');
            style.textContent = `
                .gsc-control-cse {
                    background-color: transparent !important;
                    border: none !important;
                }
                .gsc-results-wrapper-visible {
                    background-color: #363940 !important;
                }
                .gsc-webResult.gsc-result {
                    background-color: #25262a !important;
                    border: none !important;
                }
                .gs-title, .gs-title * {
                    color: #7d82f0 !important;
                }
                .gs-snippet {
                    color: #ffffff !important;
                }
                .gs-visibleUrl {
                    color: #8ab4f8 !important;
                }
                .gsc-cursor-page {
                    color: #ffffff !important;
                }
                .gsc-cursor-current-page {
                    color: #7d82f0 !important;
                }
            `;
            document.head.appendChild(style);
        };
    </script>
</body>
</html>
